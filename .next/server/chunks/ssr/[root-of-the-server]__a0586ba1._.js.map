{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 11, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sabri/Downloads/ESEO/S9/architecture/Veliseo/REP/src/components/planning-calendar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/planning-calendar.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/planning-calendar.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAwS,GACrU,sEACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sabri/Downloads/ESEO/S9/architecture/Veliseo/REP/src/components/planning-calendar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/planning-calendar.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/planning-calendar.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAoR,GACjT,kDACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sabri/Downloads/ESEO/S9/architecture/Veliseo/REP/src/actions/schedule_actions.ts"],"sourcesContent":["// 'use server'\r\n\r\n// import { pool } from \"@/lib/auth\"; // Ton pool Postgres existant\r\n// import { revalidatePath } from \"next/cache\";\r\n\r\n// // Récupérer tous les cours pour le calendrier\r\n// export async function getLessons(start: Date, end: Date) {\r\n//   // On joint avec sys.prof pour avoir le nom du prof\r\n//   // On joint avec scol.ue pour le titre (si besoin)\r\n//   const result = await pool.query(`\r\n//     SELECT \r\n//       l.id, \r\n//       l.deb as start, \r\n//       l.fin as \"end\", \r\n//       l.salle as \"resourceId\",\r\n//       l.typec as type,\r\n//       p.nom || ' ' || p.prenom as prof,\r\n//       u.label as title\r\n//     FROM scol.lecon l\r\n//     LEFT JOIN sys.prof p ON l.\"profId\" = p.id\r\n//     LEFT JOIN scol.ue u ON l.\"ueId\" = u.id\r\n//     WHERE l.deb >= $1 AND l.fin <= $2\r\n//   `, [start, end]);\r\n\r\n//   // Conversion des dates pour que React comprenne\r\n//   return result.rows.map(row => ({\r\n//     ...row,\r\n//     start: new Date(row.start),\r\n//     end: new Date(row.end),\r\n//     // Couleur conditionnelle selon le type (facultatif)\r\n//     bgColor: row.type === 'TP' ? '#ef4444' : '#3b82f6'\r\n//   }));\r\n// }\r\n\r\n// // Déplacer un cours (Drag & Drop)\r\n// export async function moveLesson(lessonId: string, newStart: Date, newEnd: Date, newRoomId: string) {\r\n  \r\n//   // 1. DÉTECTION DE CONFLIT (Ta règle d'or)\r\n//   // \"Est-ce qu'il existe un AUTRE cours dans la MÊME salle qui CHEVAUCHE mes horaires ?\"\r\n//   const conflict = await pool.query(\r\n//     `SELECT l.id, p.nom \r\n//      FROM scol.lecon l\r\n//      LEFT JOIN sys.prof p ON l.\"profId\" = p.id\r\n//      WHERE l.salle = $1 \r\n//        AND l.id != $2 -- On ne se compte pas soi-même\r\n//        AND tstzrange(l.deb, l.fin) && tstzrange($3, $4) -- L'opérateur \"overlap\" de Postgres\r\n//     `,\r\n//     [newRoomId, lessonId, newStart, newEnd]\r\n//   );\r\n\r\n//   // S'il y a un résultat, c'est qu'il y a conflit\r\n//   if (conflict.rowCount && conflict.rowCount > 0) {\r\n//     const occupant = conflict.rows[0].nom || \"un autre prof\";\r\n//     return { \r\n//       success: false, \r\n//       message: `Impossible : La salle est déjà prise par ${occupant} à cette heure.` \r\n//     };\r\n//   }\r\n\r\n//   // 2. SI TOUT EST BON : UPDATE\r\n//   try {\r\n//     await pool.query(\r\n//       `UPDATE scol.lecon SET deb = $1, fin = $2, salle = $3 WHERE id = $4`,\r\n//       [newStart, newEnd, newRoomId, lessonId]\r\n//     );\r\n    \r\n//     // On rafraîchit les données de la page pour que tout le monde voie le changement\r\n//     revalidatePath('/admin/planning'); \r\n//     return { success: true };\r\n    \r\n//   } catch (error) {\r\n//     console.error(error);\r\n//     return { success: false, message: \"Erreur technique lors de la sauvegarde.\" };\r\n//   }\r\n// }"],"names":[],"mappings":"AAAA,eAAe;AAEf,mEAAmE;AACnE,+CAA+C;AAE/C,iDAAiD;AACjD,6DAA6D;AAC7D,wDAAwD;AACxD,uDAAuD;AACvD,sCAAsC;AACtC,cAAc;AACd,eAAe;AACf,yBAAyB;AACzB,yBAAyB;AACzB,iCAAiC;AACjC,yBAAyB;AACzB,0CAA0C;AAC1C,yBAAyB;AACzB,wBAAwB;AACxB,gDAAgD;AAChD,6CAA6C;AAC7C,wCAAwC;AACxC,sBAAsB;AAEtB,qDAAqD;AACrD,qCAAqC;AACrC,cAAc;AACd,kCAAkC;AAClC,8BAA8B;AAC9B,2DAA2D;AAC3D,yDAAyD;AACzD,SAAS;AACT,IAAI;AAEJ,qCAAqC;AACrC,wGAAwG;AAExG,+CAA+C;AAC/C,4FAA4F;AAC5F,uCAAuC;AACvC,2BAA2B;AAC3B,yBAAyB;AACzB,iDAAiD;AACjD,2BAA2B;AAC3B,wDAAwD;AACxD,+FAA+F;AAC/F,SAAS;AACT,8CAA8C;AAC9C,OAAO;AAEP,qDAAqD;AACrD,sDAAsD;AACtD,gEAAgE;AAChE,gBAAgB;AAChB,yBAAyB;AACzB,wFAAwF;AACxF,SAAS;AACT,MAAM;AAEN,mCAAmC;AACnC,UAAU;AACV,wBAAwB;AACxB,8EAA8E;AAC9E,gDAAgD;AAChD,SAAS;AAET,wFAAwF;AACxF,0CAA0C;AAC1C,gCAAgC;AAEhC,sBAAsB;AACtB,4BAA4B;AAC5B,qFAAqF;AACrF,MAAM;AACN,IAAI","debugId":null}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sabri/Downloads/ESEO/S9/architecture/Veliseo/REP/src/app/admin/planning/page.tsx"],"sourcesContent":["import PlanningCalendar from \"@/components/planning-calendar\";\r\nimport { getLessons } from \"@/actions/schedule_actions\";\r\n\r\nexport default async function PlanningPage() {\r\n  // 1. On définit la plage de dates à charger (ex: Année 2025)\r\n  // Dans une vraie app, on gérerait ça dynamiquement, mais pour la démo on charge large\r\n  const start = new Date(2025, 0, 1); // 1er Janvier\r\n  const end = new Date(2025, 11, 31); // 31 Décembre\r\n\r\n  // 2. On récupère les VRAIS cours depuis Postgres\r\n  const lessons = await getLessons(start, end);\r\n\r\n  return (\r\n    <div className=\"p-6 bg-gray-50 min-h-screen\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-2xl font-bold text-gray-800\">Planning Scolaire</h1>\r\n        <div className=\"text-sm text-gray-500\">\r\n          {lessons.length} cours chargés\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 3. On passe les données au calendrier */}\r\n      <PlanningCalendar initialEvents={lessons} />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEe,eAAe;IAC5B,6DAA6D;IAC7D,sFAAsF;IACtF,MAAM,QAAQ,IAAI,KAAK,MAAM,GAAG,IAAI,cAAc;IAClD,MAAM,MAAM,IAAI,KAAK,MAAM,IAAI,KAAK,cAAc;IAElD,iDAAiD;IACjD,MAAM,UAAU,MAAM,IAAA,gJAAU,EAAC,OAAO;IAExC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAmC;;;;;;kCACjD,8OAAC;wBAAI,WAAU;;4BACZ,QAAQ,MAAM;4BAAC;;;;;;;;;;;;;0BAKpB,8OAAC,qJAAgB;gBAAC,eAAe;;;;;;;;;;;;AAGvC","debugId":null}}]
}